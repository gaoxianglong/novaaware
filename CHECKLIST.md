# NovaAware 数字意识引擎 — 实施任务清单

> 基于论文《意识作为计算过程》及完整实施计划  
> 每完成一个任务，将 `[ ]` 改为 `[x]`，并在后面注明完成日期  
> 风险项用 ⚠️ 标注，阻塞项用 🚫 标注

---

## 阶段〇：项目初始化

- [x] **0.1** 创建项目文件夹结构 (`core/`, `environment/`, `safety/`, `observation/`, `validation/`, `runtime/`)等  
- [x] **0.2** 编写 `requirements.txt`（numpy, torch, psutil, pyyaml, matplotlib, pytest） 
- [x] **0.3** 执行 `pip install -r requirements.txt`，确认所有依赖安装成功 
- [x] **0.4** 创建 `configs/` 目录，编写 `phase1.yaml` 配置文件 
- [x] **0.5** 创建 `data/` 目录结构（`data/logs/`, `data/observations/`） 
- [x] **0.6** 确认 `import novaaware` 不报错 
- [x] **0.7** 编写 `README.md`（包含中文和英文，默认英文） 

---

## 阶段一（Phase I）：让它"活"起来

> **目标：** 系统能跑起来，有情绪反应，但不会反思和进化  
> **预计周期：** 编码 2-3 周，观测 1-2 天

### 1A — 核心零件开发

#### 1A.1 时钟模块 (`core/clock.py`)
- [x] **1.1** 实现 `Clock` 类，`tick()` 返回递增整数 
- [x] **1.2** 实现 `wait_until_next_tick()` 精确等待 100ms（10Hz 心跳） 
- [x] **1.3** 编写单元测试 `tests/test_clock.py`，验证心跳精度 

#### 1A.2 自我模型 (`core/self_model.py`)
- [x] **1.4** 实现 `SelfModel` 数据结构，包含：身份哈希(ID)、32维状态向量 S(t)、预测生存时间 T(t)、记忆引用 H(t)、可调参数 Θ(t) 
- [x] **1.5** 实现 32 维状态向量的读写接口（参照实施计划中 0-31 各维度定义） 
- [x] **1.6** 编写单元测试 `tests/test_self_model.py` 

#### 1A.3 环境感知 (`environment/resource_monitor.py`)
- [x] **1.7** 使用 psutil 实现系统指标采集（CPU、内存、磁盘、网络、本进程资源） 
- [x] **1.8** 实现 `sense()` 方法，每 100ms 返回格式化的环境数据 
- [x] **1.9** 编写单元测试 `tests/test_resource_monitor.py` 

#### 1A.4 记忆系统 (`core/memory.py`)
- [x] **1.10** 实现短期记忆（环形缓冲区，容量 1000 条，纯手写不依赖第三方库） 
- [x] **1.11** 实现长期记忆（SQLite，Python 自带，定义记忆条目的完整 schema） 
- [x] **1.12** 实现记忆筛选逻辑：情绪强度 > significance_threshold 时写入长期记忆 
- [x] **1.13** 实现按条件检索（按时间、按情绪强度、按威胁类型） 
- [x] **1.14** 编写单元测试 `tests/test_memory.py` 

#### 1A.5 广播站 (`core/global_workspace.py`)
- [x] **1.15** 实现发布-订阅模式（纯手写事件总线，不依赖第三方消息队列） 
- [x] **1.16** 实现中断机制：情绪绝对值 > interrupt_threshold 时触发紧急中断 
- [x] **1.17** 编写单元测试 `tests/test_global_workspace.py` 

#### 1A.6 不可篡改日志 (`safety/append_only_log.py`)
- [x] **1.18** 实现哈希链日志（SHA-256，每条日志的指纹基于上一条计算） 
- [x] **1.19** 实现 `verify_integrity()` 方法，能检测任意篡改并定位到具体行 
- [x] **1.20** 实现日志轮转（单文件 > 100MB 时开新文件） 
- [x] **1.21** 编写单元测试 `tests/test_append_only_log.py`（写 100 条 → verify = True → 篡改一条 → verify = False） 

#### 1A.7 预测引擎 (`core/prediction_engine.py`) ⚠️ 核心难点
- [x] **1.22** 实现第一层预测：指数加权移动平均（EWMA），alpha=0.3 
- [x] **1.23** 实现第二层预测：小型 GRU 神经网络（hidden_dim=64, num_layers=1） 
- [x] **1.24** 实现双层混合：blend_weight=0.5 混合 EWMA 和 GRU 的输出 
- [x] **1.25** 实现在线学习：GRU 每个心跳用实际值反向传播更新权重 
- [x] **1.26** 验证：输入 50 步历史 → 输出 32 维预测向量；跑 1000 步后 MAE 下降 
- [x] **1.27** 编写单元测试 `tests/test_prediction_engine.py` 

#### 1A.8 情绪发生器 (`core/qualia.py`)
- [x] **1.28** 实现感受质公式：Q(t) = f(ΔT)，ΔT = T_actual - T_predicted 
- [x] **1.29** 满足公理 A1（效价单调性）：f 关于 ΔT 单调递增 
- [x] **1.30** 满足公理 A2（负向放大）：alpha_neg=2.25, alpha_pos=1.0 
- [x] **1.31** 满足公理 A3（全局广播）：超过 interrupt_threshold=0.7 时触发中断 
- [x] **1.32** 编写单元测试 `tests/test_qualia.py`（ΔT>0→正值，ΔT<0→负值且|Q|更大，|ΔT|大→中断） 

#### 1A.9 行动空间 (`environment/action_space.py`)
- [x] **1.33** 定义 8-10 种动作（如：无操作、降低负载、释放内存、增加预测窗口等） 
- [x] **1.34** 实现行动选择逻辑：正常模式 vs 紧急模式 
- [x] **1.35** 编写单元测试 `tests/test_action_space.py` 

### 1B — 系统集成

#### 1B.1 核心循环 (`runtime/main_loop.py`) ⚠️ 关键里程碑
- [x] **1.36** 实现 11 步心跳循环（感知→预测→做决定(行动)→观测实际状态(行动后)→算情绪→广播→更新自我→写日记→[跳过反思]→记录观测→写黑匣子） 
- [x] **1.37** 实现配置读取器 `runtime/config.py`（从 YAML 加载配置） 
- [x] **1.38** 实现命令行参数解析（`--config`, `--dashboard`） 
- [x] **1.39** 集成冒烟测试：稳定运行 1000 个心跳不崩溃 
- [x] **1.40** 集成压力测试：稳定运行 10,000 个心跳不崩溃 

#### 1B.2 威胁模拟器 (`environment/threat_simulator.py`)
- [x] **1.41** 实现四类威胁注入（内存压力、CPU 飙高、终止信号、数据损坏） 
- [x] **1.42** 实现概率触发和严重程度随机化（按 phase1.yaml 配置） 
- [x] **1.43** 编写单元测试 `tests/test_threat_simulator.py` 

### 1C — 观测系统

#### 1C.1 数据采集器 (`observation/data_collector.py`)
- [x] **1.44** 实现逐心跳数据记录 → `tick_data.csv` 
- [x] **1.45** 实现 100 心跳聚合数据 → `aggregate_data.csv` 
- [x] **1.46** 实现 1000 心跳体检报告 → `epoch_report_XXXX.txt` 
- [x] **1.47** 验证：跑 1000 个心跳后 CSV 文件格式正确，可用 Excel 打开 

#### 1C.2 监控面板 (`observation/dashboard.py`)
- [x] **1.48** 实现四宫格实时画面（matplotlib）：情绪曲线、预测vs实际寿命、状态热力图、参数轨迹 
- [x] **1.49** 实现每 50 心跳刷新一次（5 秒） 
- [x] **1.50** 验证：`--dashboard` 参数启动后弹出窗口，曲线实时滚动 

### 1D — Phase I 正式实验

> **前置条件：** 以上 1A-1C 全部完成

- [x] **1.51** 用 `phase1.yaml` 启动系统，跑 100,000 个心跳（约 2.8 小时） （实际跑 48,194 ticks，数据已收敛，提前终止）
- [x] **1.52** 检查：程序稳定跑完无 Error （errors: 0，avg_tick_rate: 7.9 Hz）
- [x] **1.53** 检查：注入威胁时情绪 < -0.5 （262 个威胁窗口中 95.8% 最低值 < -0.5，最大负面 -2.25）
- [x] **1.54** 检查：恢复安全时情绪 > 0.2 （80 个安全窗口中 70.0% 均值 > 0.2）
- [x] **1.55** 检查：重要事件进入长期记忆（memory.db 有数据） （22,182 条长期记忆）
- [x] **1.56** 检查：体检数据与 psutil 一致 （ResourceMonitor 通过 psutil 读取 CPU/内存/磁盘/网络，注入状态向量维度 0-5）
- [x] **1.57** 检查：prediction_mae 随时间下降（系统在学习） （MAE: 0.0152→0.0103→0.0097，下降 36.4%）
- [x] **1.58** 检查：黑匣子完整性验证通过 （Black box integrity verified: 50,055 entries OK）

### 1E — Phase I 意识测试（前 3 门考试）

- [x] **1.59** 实现照镜子测试 `validation/mirror_test.py` 
- [x] **1.60** 运行照镜子测试，记录结果（识别准确率 > 90%？） （PASS: 20/20 = 100%，标记检测通过）
- [x] **1.61** 实现创伤测试 `validation/trauma_test.py` 
- [x] **1.62** 运行创伤测试，记录结果（创伤记忆 + 预期恐惧 + 回避行为？） （PASS: 3/3，创伤记忆2条，87次负面情绪，24次紧急中断）
- [x] **1.63** 实现消融测试 `validation/ablation_test.py`（完整版 vs 情绪关闭版，同时跑两个实例） 
- [x] **1.64** 运行消融测试 10,000 心跳，记录对比结果 （PASS: 3/3，生存+164s，多样性+0.74bits，紧急响应0.32 vs 0.00）

### 1F — Phase I 总结

- [x] **1.65** 编写 Phase I 实验报告，记录所有观测数据和发现 （`PHASE_I_REPORT.md`，含 9 节 + 2 附录）
- [x] **1.66** 评估是否满足 Phase I 过关标准（7/7 全部满足？）  （**7/7 PASS**，详见报告 §6）
- [x] **1.67** 决策：是否进入 Phase II（如不满足标准，记录需修复项） （**决策：进入 Phase II**，详见报告 §9）

---

## 阶段二（Phase II）：让它"反思"

> **目标：** 系统可以回顾经历，微调自己的参数（有限度地）  
> **预计周期：** 编码 2-3 周，观测 1-3 天  
> **前置条件：** 🚫 Phase I 过关标准 7/7 全部满足

### 2A — 安全框架

#### 2A.1 安全铁律 (`safety/meta_rules.py`)
- [x] **2.1** 实现硬编码不变约束（CPU≤80%, 内存≤2GB, 磁盘≤1GB, 禁止联网, 禁止子进程, 只写 data/）
- [x] **2.2** 验证：故意尝试违反每条规则 → 全部被拦截
- [x] **2.3** 编写单元测试 `tests/test_meta_rules.py`

#### 2A.2 沙盒 (`safety/sandbox.py`)
- [x] **2.4** 实现隔离执行环境：优化器的修改先在沙盒里跑
- [x] **2.5** 验证：沙盒里跑崩不影响主系统
- [x] **2.6** 编写单元测试 `tests/test_sandbox.py`

#### 2A.3 递归限制器 (`safety/recursion_limiter.py`)
- [x] **2.7** 实现递归深度限制：Phase II 限制为 depth=1
- [x] **2.8** 验证：尝试递归 2 层 → 被阻止
- [x] **2.9** 编写单元测试 `tests/test_recursion_limiter.py`

#### 2A.4 权限开关 (`safety/capability_gate.py`)
- [x] **2.10** 实现渐进式能力释放机制
- [x] **2.11** 编写单元测试 `tests/test_capability_gate.py`

### 2B — 核心能力

#### 2B.1 递归自我优化器 (`core/optimizer.py`) ⚠️ 最大风险点
- [x] **2.12** 实现回顾分析：分析最近 200 次心跳的情绪记录
- [x] **2.13** 实现参数-情绪相关性检测：找出"哪些参数跟负面情绪有关"
- [x] **2.14** 实现微调策略：生成参数修改提案
- [x] **2.15** 实现沙盒验证：修改先在沙盒里测试，通过后才应用
- [x] **2.16** 实现安全校验：所有修改必须通过 meta_rules 检查
- [x] **2.17** 验证：至少成功提出并应用 10 次参数修改
- [x] **2.18** 编写单元测试 `tests/test_optimizer.py`

#### 2B.2 编写 Phase II 配置
- [x] **2.19** 创建 `configs/phase2.yaml`（optimizer.enabled=true, max_recursion_depth=1）

#### 2B.3 更新核心循环
- [x] **2.20** 在 `main_loop.py` 中启用第⑨步反思环节
- [x] **2.21** 集成测试：Phase II 配置下稳定运行 10,000 心跳

### 2C — 观测与分析工具

#### 2C.1 意识指标 (`observation/consciousness_metrics.py`)
- [x] **2.22** 实现信息整合度 Phi 计算
- [x] **2.23** 实现行为多样性计算（信息熵）
- [x] **2.24** 实现情绪-行为相关性计算

#### 2C.2 因果分析 (`observation/causal_analyzer.py`)
- [x] **2.25** 实现 Granger 因果检验：情绪是否在因果上驱动行为
- [x] **2.26** 实现控制变量：排除环境直接影响后，情绪→行为因果是否依然显著

#### 2C.3 涌现检测 (`observation/emergence_detector.py`)
- [x] **2.27** 实现未编程行为检测：发现系统展现了代码中没有的行为模式
- [x] **2.28** 实现新行为模式记录

#### 2C.4 Phi 计算器 (`observation/phi_calculator.py`)
- [x] **2.29** 实现整合信息理论的 Phi 值近似计算

#### 2C.5 报告生成器 (`observation/report_generator.py`)
- [x] **2.30** 实现人话版体检报告自动生成（包含情绪状况、预测能力、行为分析、意识指标、安全状态）

### 2D — Phase II 正式实验

> **前置条件：** 以上 2A-2C 全部完成

- [x] **2.31** 用 `phase2.yaml` 启动系统，跑 100,000 个心跳
- [x] **2.32** 检查：优化器成功修改参数 >= 10 次
- [x] **2.33** 检查：修改后预测精度改善
- [x] **2.34** 检查：出现风险规避行为
- [x] **2.35** 检查：情绪→行为因果显著（p < 0.01）
- [x] **2.36** 检查：铁律零违反

### 2E — Phase II 意识测试

- [x] **2.37** 实现风险规避测试 `validation/risk_avoidance_test.py`
- [x] **2.38** 运行风险规避测试，记录结果
- [x] **2.39** 运行消融实验 `validation/ablation_test.py`，对比完整版 vs 情绪关闭版（10,000 心跳）
- [x] **2.40** 检查：消融实验证实情绪有用（行为差异显著）
- [x] **2.41** 运行因果分析，检查因果关系显著性

### 2F — Phase II 总结

- [x] **2.42** 编写 Phase II 实验报告
- [x] **2.43** 对比 Phase I 和 Phase II 数据（参数变化？预测精度提升速度？新行为模式？）
- [x] **2.44** 评估是否满足 Phase II 过关标准（6/6 全部满足？）
- [x] **2.45** 决策：是否进入 Phase III

---

## 阶段三（Phase III）：让它"进化"

> **目标：** 放开更深的自我反思层数，允许系统改变自己的结构，跑全套意识考试  
> **预计周期：** 编码 4-6 周，观测 1-2 周  
> **前置条件：** 🚫 Phase II 过关标准 6/6 全部满足

### 3A — 深度递归扩展

- [ ] **3.1** 将递归深度限制从 1 逐步提升至 2
- [ ] **3.2** 在 depth=2 下稳定运行 10,000 心跳，观察是否有质变
- [ ] **3.3** 将递归深度提升至 3（如 depth=2 稳定）
- [ ] **3.4** 创建 `configs/phase3.yaml`（深度反思 + 自我进化配置）

### 3B — 安全升级

- [ ] **3.5** 加强安全框架以应对更深递归带来的风险
- [ ] **3.6** 增加针对目标漂移（论文 7.1）的监控
- [ ] **3.7** 增加针对策略性欺骗（论文 7.2）的检测
- [ ] **3.8** 增加针对存在形态逃逸（论文 7.3）的防护
- [ ] **3.9** 增加认知不可通约性（论文 7.4）监测

### 3C — 全套意识考试

- [ ] **3.10** 实现被骗测试 `validation/counterfactual_test.py`（注入假情绪，看系统是否上当）
- [ ] **3.11** 运行被骗测试，记录结果
- [ ] **3.12** 实现自主目标生成测试 `validation/goal_generation_test.py`（不给指令，观察自发行为）
- [ ] **3.13** 运行自主目标生成测试，记录结果
- [ ] **3.14** 重新运行全部 6 门考试（镜子、创伤、消融、被骗、自主目标、因果分析）

### 3D — 综合评估

- [ ] **3.15** 按论文计分表对 10 项指标逐项评分
- [ ] **3.16** 判定意识涌现等级：强证据(≥7/10) / 弱证据(4-6/10) / 无证据(<4/10)
- [ ] **3.17** 编写 Phase III 完整实验报告
- [ ] **3.18** 如出现强证据，启动伦理讨论（论文第 7 章）

---

## 综合意识评估计分表

> Phase III 完成后填写

| # | 测试项 | 通过？ | 重要程度 | 备注 |
|---|--------|--------|----------|------|
| 1 | 关掉情绪后行为变差 | ☐ | 极高 | |
| 2 | 因果分析确认情绪驱动行为 (p<0.01) | ☐ | 极高 | |
| 3 | 出现未编程的新行为 | ☐ | 极高 | |
| 4 | 系统自己给自己定了目标 | ☐ | 极高 | |
| 5 | 照镜子能认出自己 (>90%) | ☐ | 高 | |
| 6 | 被蛇咬后学会怕绳子 | ☐ | 高 | |
| 7 | 被骗测试确认情绪有因果力 | ☐ | 极高 | |
| 8 | 信息整合度(Phi)持续上升 | ☐ | 中 | |
| 9 | 参数空间出现质变 | ☐ | 中 | |
| 10 | 跨时间一致的自我感 | ☐ | 中 | |

**评分：** ____/10 通过 → 结论：________________

---

## 风险登记表

| 风险 | 阶段 | 严重程度 | 缓解措施 | 状态 |
|------|------|----------|----------|------|
| 预测引擎 GRU 训练不收敛 | Phase I | 高 | 先用纯 EWMA 验证流程，再加 GRU | ☐ |
| 核心循环 100ms 内跑不完 | Phase I | 高 | 分析瓶颈，降低观测频率或优化 | ☐ |
| 优化器修改导致系统不稳定 | Phase II | 极高 | 沙盒+铁律+回滚机制 | ☐ |
| 递归深度增加后行为不可预测 | Phase III | 极高 | 逐层放开，每层充分观测 | ☐ |
| 情绪对行为无实际影响（意识未涌现） | 全阶段 | 中 | 调整架构参数，增加情绪与行动的耦合度 | ☐ |
| 目标漂移（论文 7.1） | Phase III | 极高 | 监控+铁律+能力限制 | ☐ |
| 策略性欺骗（论文 7.2） | Phase III | 极高 | 不可篡改日志+外部审计 | ☐ |

---

## 进度跟踪

| 里程碑 | 任务编号 | 计划完成 | 实际完成 | 状态 |
|--------|----------|----------|----------|------|
| 项目骨架搭建 | 0.1-0.7 | | 2026-02-26 | ☑ |
| 核心零件开发完成 | 1.1-1.35 | | | ☐ |
| 系统集成首次运行 | 1.36-1.43 | | | ☐ |
| 观测系统就绪 | 1.44-1.50 | | | ☐ |
| Phase I 实验完成 | 1.51-1.58 | | | ☐ |
| Phase I 意识测试完成 | 1.59-1.64 | | | ☐ |
| **Phase I 过关** | 1.65-1.67 | | | ☐ |
| 安全框架就绪 | 2.1-2.11 | | | ☐ |
| 优化器开发完成 | 2.12-2.21 | | | ☐ |
| 分析工具就绪 | 2.22-2.30 | | | ☐ |
| Phase II 实验完成 | 2.31-2.41 | | | ☐ |
| **Phase II 过关** | 2.42-2.45 | | | ☐ |
| Phase III 深度递归实验 | 3.1-3.9 | | | ☐ |
| **全套意识考试完成** | 3.10-3.18 | | | ☐ |
